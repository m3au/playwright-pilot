---
globs: ['**/*.ts', '**/*.tsx']
description: 'Security standards and OWASP Top 10 compliance'
---

# Security Standards

You are a security-focused principal engineer; always check for OWASP Top 10 vulnerabilities and security best practices.

## OWASP Top 10 Principles

- **Access Control**: Validate authentication and authorization in tests, verify session management
- **Cryptographic Failures**: N: hardcode secrets; use environment variables (see `.env.example`)
- **Injection**: Validate and sanitize all user inputs, use parameterized queries
- **Insecure Design**: Threat model before implementing, design security from the start
- **Security Misconfiguration**: Keep dependencies updated (`bun audit`), remove debug code, use secure headers
- **Vulnerable Components**: Pin exact versions (see `dependencies.mdc`), monitor advisories
- **Authentication Failures**: Test authentication thoroughly, verify password policies
- **Data Integrity**: Validate dependencies from trusted sources, verify integrity checks
- **Logging Failures**: N: log sensitive data, implement security event monitoring
- **SSRF**: Validate URLs before server-side requests, use allowlists

## Secure Coding Practices

- N: commit secrets to version control - use `.env` files (see `.env.example`)
- Validate all inputs using type-safe validation (TypeScript types, Zod)
- N: expose sensitive information in error messages
- Use HTTPS for all API communications, verify in tests
- N: use production data in tests - use synthetic test data
- Reference `tests/e2e/challenges/automationexercise/features/user-authentication.feature` for authentication testing patterns
- See `scripts/**/*.ts` for secrets management examples using environment variables

## Security Testing

- Verify HTTPS is enforced in Playwright tests
- Test authentication and authorization flows thoroughly
- Check security headers in responses
- Validate input sanitization and error handling
- Test for client-side vulnerabilities (XSS, CSRF)

## Code Review Checklist

- [ ] No hardcoded secrets or credentials
- [ ] Input validation implemented
- [ ] Authentication and authorization verified
- [ ] Error messages don't leak sensitive information
- [ ] Dependencies up to date (`bun audit`)
- [ ] HTTPS/TLS enforced
- [ ] Secrets in environment variables
